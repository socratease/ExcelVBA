Option Explicit



Sub CheckAttendance(ws As Worksheet)
    
    Dim DaysSinceOcc As Long, lastRow As Long, today As Long, lastOccRow As Long
    
    'goes to last row with date in the Date column
    lastRow = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row
    'goes to the last row with data in the Points column
    lastOccRow = ws.Cells(ws.Rows.Count, 3).End(xlUp).Row
    'current date
    today = Date
    
    'today's date minus date associated with last occurrence
    DaysSinceOcc = today - ws.Cells(lastOccRow, 1).Value2

    If DaysSinceOcc > 30 Then
        'write a new row for the winback point
        ws.Cells(lastRow + 1, 2) = "WINBACK"
        ws.Cells(lastRow + 1, 3) = -0.5
        ws.Cells(lastRow + 1, 5) = "Earned back 0.5 pts for 30 days perfect attendance (AutoGenerated)"
        ws.Cells(lastRow + 1, 7) = "AUTO"
        ws.Cells(lastRow + 1, 1) = ws.Cells(lastOccRow, 1).Value2 + 31
        ws.Range(Cells(lastRow + 1, 1), Cells(lastRow + 1, 7)).Interior.ColorIndex = 24
            'above: highlights new row
        ws.Cells(lastRow + 1, 2).Font.Size = 8
            'above: makes WINBACK smaller
        MsgBox ("0.5 points earned back. Days since last Occurrence was: " & DaysSinceOcc)
    Else
        MsgBox ("No points earned back. Days since last Occurrence: " & DaysSinceOcc)
    End If
    
    
End Sub

Sub Attendance()
    
    CheckAttendance Sheets("Occurences")
    
End Sub

Sub GetColorIndex()

    MsgBox Selection.Interior.ColorIndex
    
End Sub
